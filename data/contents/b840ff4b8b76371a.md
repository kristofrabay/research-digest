# GitHub - 1989Ryan/llm-mcts: [NeurIPS 2023] We use large language models as commonsense world model and heuristic policy within Monte-Carlo Tree Search, enabling better-reasoned decision-making for daily task planning problems.

**URL:** https://github.com/1989Ryan/llm-mcts
**Published:** 2023-05-22T02:10:03.000Z

---

## Summary

The webpage describes the **llm-mcts** GitHub repository, which implements a method for **task planning** using **Large Language Models (LLMs)** within **Monte Carlo Tree Search (MCTS)**.

Specifically, the LLMs are used as both the **commonsense world model** and the **heuristic policy** within MCTS. This approach aims to enable **better-reasoned decision-making for daily task planning problems** by providing MCTS with a commonsense prior belief of states and guiding the search to reduce complexity. The work is associated with a **NeurIPS 2023** paper.

The query covers several topics related to advanced LLM capabilities, including: *reasoning, chain-of-thought, inference-time compute, self-reflection, planning with LLMs, MCTS, test-time scaling, hallucination reduction, grounding, and factuality*.

The page directly addresses **planning with LLMs** and **MCTS (Monte Carlo Tree Search) for language models** in the context of task planning. It does not explicitly detail reasoning techniques like chain-of-thought, inference-time compute specifics, self-reflection, test-time scaling, or methods for hallucination reduction/detection, grounding, or factuality beyond the general goal of "better-reasoned decision-making."

---

## Full Content

[Skip to content](https://github.com/github.com#start-of-content)

You signed in with another tab or window. Reload to refresh your session.You signed out in another tab or window. Reload to refresh your session.You switched accounts on another tab or window. Reload to refresh your session.Dismiss alert

[1989Ryan](https://github.com/1989Ryan)/ **[llm-mcts](https://github.com/1989Ryan/llm-mcts)** Public

- [Notifications](https://github.com/login?return_to=%2F1989Ryan%2Fllm-mcts) You must be signed in to change notification settings
- [Fork\
26](https://github.com/login?return_to=%2F1989Ryan%2Fllm-mcts)
- [Star\
290](https://github.com/login?return_to=%2F1989Ryan%2Fllm-mcts)


\[NeurIPS 2023\] We use large language models as commonsense world model and heuristic policy within Monte-Carlo Tree Search, enabling better-reasoned decision-making for daily task planning problems.

[llm-mcts.github.io/](https://llm-mcts.github.io/)

### License

[Apache-2.0 license](https://github.com/1989Ryan/llm-mcts/blob/main/LICENSE)

[290\
stars](https://github.com/1989Ryan/llm-mcts/stargazers) [26\
forks](https://github.com/1989Ryan/llm-mcts/forks) [Branches](https://github.com/1989Ryan/llm-mcts/branches) [Tags](https://github.com/1989Ryan/llm-mcts/tags) [Activity](https://github.com/1989Ryan/llm-mcts/activity)

[Star](https://github.com/login?return_to=%2F1989Ryan%2Fllm-mcts)

[Notifications](https://github.com/login?return_to=%2F1989Ryan%2Fllm-mcts) You must be signed in to change notification settings

# 1989Ryan/llm-mcts

main

[Branches](https://github.com/1989Ryan/llm-mcts/branches) [Tags](https://github.com/1989Ryan/llm-mcts/tags)

Go to file

Code

Open more actions menu

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit ## History [9 Commits](https://github.com/1989Ryan/llm-mcts/commits/main/) |
| [data](https://github.com/1989Ryan/llm-mcts/tree/main/data) | [data](https://github.com/1989Ryan/llm-mcts/tree/main/data) |
| [expert\_actions](https://github.com/1989Ryan/llm-mcts/tree/main/expert_actions) | [expert\_actions](https://github.com/1989Ryan/llm-mcts/tree/main/expert_actions) |
| [mcts](https://github.com/1989Ryan/llm-mcts/tree/main/mcts) | [mcts](https://github.com/1989Ryan/llm-mcts/tree/main/mcts) |
| [media](https://github.com/1989Ryan/llm-mcts/tree/main/media) | [media](https://github.com/1989Ryan/llm-mcts/tree/main/media) |
| [scripts](https://github.com/1989Ryan/llm-mcts/tree/main/scripts) | [scripts](https://github.com/1989Ryan/llm-mcts/tree/main/scripts) |
| [vh](https://github.com/1989Ryan/llm-mcts/tree/main/vh) | [vh](https://github.com/1989Ryan/llm-mcts/tree/main/vh) |
| [.gitignore](https://github.com/1989Ryan/llm-mcts/blob/main/.gitignore) | [.gitignore](https://github.com/1989Ryan/llm-mcts/blob/main/.gitignore) |
| [.gitmodules](https://github.com/1989Ryan/llm-mcts/blob/main/.gitmodules) | [.gitmodules](https://github.com/1989Ryan/llm-mcts/blob/main/.gitmodules) |
| [LICENSE](https://github.com/1989Ryan/llm-mcts/blob/main/LICENSE) | [LICENSE](https://github.com/1989Ryan/llm-mcts/blob/main/LICENSE) |
| [README.md](https://github.com/1989Ryan/llm-mcts/blob/main/README.md) | [README.md](https://github.com/1989Ryan/llm-mcts/blob/main/README.md) |
| [requirement.txt](https://github.com/1989Ryan/llm-mcts/blob/main/requirement.txt) | [requirement.txt](https://github.com/1989Ryan/llm-mcts/blob/main/requirement.txt) |
| View all files |

## Repository files navigation

# llm-mcts

This repository contains the code for NeurIPS'23 paper: [Large language models as commonsense knowledge for large-scale task planning](https://arxiv.org/abs/2305.14078).

We use Large Language Models as both the commonsense world model and the heuristic policy within Monte Carlo Tree Search. LLM's world model provides with MCTS a commonsense prior belief of states for reasoned decision-making. The LLM's heuristic policy guides the search to relevant parts of the tree, substantially reducing the search complexity.

## Updates

- \[25 Feb 2024\] We have updated the code to use the latest version of the OpenAI API.

## Cite

```
@inproceedings{
 zhao2023large,
 title={Large Language Models as Commonsense Knowledge for Large-Scale Task Planning},
 author={Zirui Zhao and Wee Sun Lee and David Hsu},
 booktitle={Thirty-seventh Conference on Neural Information Processing Systems},
 year={2023},
 url={https://openreview.net/forum?id=Wjp1AYB8lH}
}

```

## Install

Install the repo:

```
git clone --recurse-submodules https://github.com/1989Ryan/llm-mcts.git

```

You need to first install virtual home. Please follow with the link at [here](https://github.com/1989Ryan/llm-mcts/blob/main/vh/vh_sim/README_Download.md) as well as the official repository at [here](https://github.com/xavierpuigf/virtualhome) to install.

To intall the dependencies in our method, run

```
pip install -r requirement.txt

```

## Generate Data

We use the code from [here](https://github.com/xavierpuigf/watch_and_help) to generate the data. You can also use the script at [here](https://github.com/1989Ryan/llm-mcts/blob/main/scripts/gene_data.sh) to generate the data.

To generate data, you need to generate the goal of a domain first, using the command

```
python vh/data_gene/gen_data/vh_init.py \
 --port "{Port Number}" \
 --task {choose your task} \
 --mode {choose one difficulty} \
 --usage {training or testing} \
 --num-per-apartment {a number}

```

Then, to generate expert data, you need to use

```
python vh/data_gene/testing_agents/gene_data.py \
 --mode {difficulty} \
 --dataset_path {the path to the file generated in the previous step}\
 --base-port {port number}

```

After that, we need to pre-process the expert data

```
python mcts/virtualhome/expert_data.py

```

## Run

Add your openai api key in both `./mcts/virtualhome/llm_model.py` and `./mcts/virtualhome/llm_policy.py`.

Generate the world model by LLM:

```
python mcts/virtualhome/llm_model.py

```

To run the code for LLM-MCTS, use

```
python mcts/virtualhome/mcts_agent.py \
 --exploration_constant 24 \
 --max_episode_len 50 \
 --max_depth 20 \
 --round 0 \
 --simulation_per_act 2 \
 --simulation_num 100 \
 --discount_factor 0.95 \
 --uct_type PUCT \
 --mode simple \
 --seen_item \
 --seen_apartment\
 --model gpt-3.5-turbo-0125 \
 --seen_comp

```

## Acknowledge

This repository is built upon a number of prior opensource works.

- Our data generation and testing settings are adapted from [https://github.com/xavierpuigf/watch\_and\_help](https://github.com/xavierpuigf/watch_and_help).
- The baseline (fine-tuned GPT2 policy) is adapted from [https://github.com/ShuangLI59/Pre-Trained-Language-Models-for-Interactive-Decision-Making](https://github.com/ShuangLI59/Pre-Trained-Language-Models-for-Interactive-Decision-Making). Their training code is available in the supplementary materials at [https://openreview.net/forum?id=FWMQYjFso-a](https://openreview.net/forum?id=FWMQYjFso-a).
- GPT3.5 baseline is adapted from [https://github.com/huangwl18/language-planner](https://github.com/huangwl18/language-planner).
- Our MCTS implementation is adapted from [https://github.com/jys5609/MC-LAVE-RL](https://github.com/jys5609/MC-LAVE-RL).

## About

\[NeurIPS 2023\] We use large language models as commonsense world model and heuristic policy within Monte-Carlo Tree Search, enabling better-reasoned decision-making for daily task planning problems.

[llm-mcts.github.io/](https://llm-mcts.github.io/)

### Topics

[task-planning](https://github.com/topics/task-planning) [large-language-models](https://github.com/topics/large-language-models) [neurips-2023](https://github.com/topics/neurips-2023)

### Resources

[Readme](https://github.com/github.com#readme-ov-file)

### License

[Apache-2.0 license](https://github.com/github.com#Apache-2.0-1-ov-file)

### Uh oh!

There was an error while loading. Please reload this page.

[Activity](https://github.com/1989Ryan/llm-mcts/activity)

### Stars

[**290**\
stars](https://github.com/1989Ryan/llm-mcts/stargazers)

### Watchers

[**5**\
watching](https://github.com/1989Ryan/llm-mcts/watchers)

### Forks

[**26**\
forks](https://github.com/1989Ryan/llm-mcts/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F1989Ryan%2Fllm-mcts&report=1989Ryan+%28user%29)

## [Releases](https://github.com/1989Ryan/llm-mcts/releases)

No releases published

## [Packages\ 0](https://github.com/users/1989Ryan/packages?repo_name=llm-mcts)

No packages published

### Uh oh!

There was an error while loading. Please reload this page.

## [Contributors\ 2](https://github.com/1989Ryan/llm-mcts/graphs/contributors)

### Uh oh!

There was an error while loading. Please reload this page.

## Languages

- [Python98.9%](https://github.com/1989Ryan/llm-mcts/search?l=python)
- [Shell1.1%](https://github.com/1989Ryan/llm-mcts/search?l=shell)

You canâ€™t perform that action at this time.
