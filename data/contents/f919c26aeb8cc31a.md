# Vector databases

**URL:** https://learn.microsoft.com/en-us/fabric/real-time-intelligence/vector-database
**Published:** 2024-11-19T00:00:00.000Z

---

## Summary

The webpage provides an overview of **Vector Databases**, explaining that they store and manage data as **vectors** (numerical arrays) to enable complex queries like vector similarity search, quantization, and clustering, which traditional databases struggle with due to high-dimensional data.

Key concepts covered include:
*   **Vector Similarity:** Measuring how similar or different two vectors are using distance metrics like Euclidean distance or cosine similarity.
*   **Embeddings:** Mathematical representations of data (text, images, etc.) that capture semantic meaning. These are often generated by Large Language Models (LLMs) and are stored in the vector database.

The general workflow for using a vector database is:
1.  **Embed data** using a model.
2.  **Store vectors** in the database.
3.  **Embed the query** using the same model.
4.  **Query vectors** using similarity search to find matches.

The article then focuses on using **Eventhouse in Microsoft Fabric as a vector database**, highlighting features like the `dynamic` data type for storage, the `Vector16` encoding type for reduced storage and faster processing, and the `series_cosine_similarity` function for searching. It also details steps to **optimize for scale** by setting the encoding to `Vector16` and adjusting sharding and merging policies.

---

## Full Content

Vector database - Microsoft Fabric | Microsoft Learn
[Skip to main content](#main)[Skip to Ask Learn chat experience](#)
This browser is no longer supported.
Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.
[Download Microsoft Edge]()[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)
[Learn](https://learn.microsoft.com/en-us/)[](https://www.microsoft.com)
Suggestions will filter as you type
[Sign in](#)
![]()
![]()
* [Profile](https://learn.microsoft.com/en-us/users/me/activity/)
* [Settings](https://learn.microsoft.com/en-us/users/me/settings/)
[Sign out](#)
[](https://www.microsoft.com)
[Learn](https://learn.microsoft.com/en-us/)
Suggestions will filter as you type
[Sign in](#)
![]()
![]()
* [Profile](https://learn.microsoft.com/en-us/users/me/activity/)
* [Settings](https://learn.microsoft.com/en-us/users/me/settings/)
[Sign out](#)
[Microsoft Fabric](https://learn.microsoft.com/en-us/fabric/)
[Free account](https://learn.microsoft.com/fabric/get-started/fabric-trial)[Open Fabric](https://app.fabric.microsoft.com/?pbi_source=learn-header-fabric)
Table of contentsExit editor mode
Ask LearnAsk LearnFocus mode
Table of contents[Read in English](https://learn.microsoft.com/en-us/fabric/real-time-intelligence/vector-database)Add to CollectionsAdd to plan[Edit](https://github.com/MicrosoftDocs/fabric-docs/blob/main/docs/real-time-intelligence/vector-database.md)
#### Share via
[Facebook](https://www.facebook.com/sharer/sharer.php?u=https://learn.microsoft.com/en-us/fabric/real-time-intelligence/vector-database?WT.mc_id=facebook)[x.com](https://twitter.com/intent/tweet?original_referer=https://learn.microsoft.com/en-us/fabric/real-time-intelligence/vector-database?WT.mc_id=twitter&amp;tw_p=tweetbutton&amp;url=https://learn.microsoft.com/en-us/fabric/real-time-intelligence/vector-database?WT.mc_id=twitter)[LinkedIn]()[Email]()
Print
Note
Access to this page requires authorization. You can try[signing in](#)orchanging directories.
Access to this page requires authorization. You can trychanging directories.
# Vector databases
Feedback
Summarize this article for me
A vector database stores and manages data in the form of vectors, which are numerical arrays of data points.
The use of vectors allows for complex queries and analyses, because vectors can be compared and analyzed using advanced techniques such as vector similarity search, quantization and clustering.
Traditional databases aren't well-suited for handling the high-dimensional data that is becoming increasingly common in data analytics. However, vector databases are designed to handle high-dimensional data, such as text, images, and audio, by representing them as vectors. Vector databases are useful for tasks such as machine learning, natural language processing, and image recognition, where the goal is to identify patterns or similarities in large datasets.
This article gives some background about vector databases and explains conceptually how you can use an[Eventhouse](eventhouse)as a vector database in Real-Time Intelligence in Microsoft Fabric. For a practical example, see[Tutorial: Use an Eventhouse as a vector database](vector-database-eventhouse).
[](#key-concepts)## Key concepts
The following key concepts are used in vector databases:
[](#vector-similarity)### Vector similarity
Vector similarity is a measure of how different (or similar) two or more vectors are. Vector similarity search is a technique used to find similar vectors in a dataset. Vectors are compared using a distance metric, such as[Euclidean distance](https://en.wikipedia.org/wiki/Euclidean_distance)or[cosine similarity](https://en.wikipedia.org/wiki/Cosine_similarity). The closer two vectors are, the more similar they are.
[](#embeddings)### Embeddings
Embeddings are a common way of representing data in a vector format for use in vector databases. An embedding is a mathematical representation of a piece of data, such as a word, text document, or an image, that is designed to capture its semantic meaning. Embeddings are created using algorithms that analyze the data and generate a set of numerical values that represent its key features. For example, an embedding for a word might represent its meaning, its context, and its relationship to other words. The process of creating embeddings is straightforward. While they can be created using standard python packages (for example, spaCy, sent2vec, Gensim), Large Language Models (LLM) generate highest quality embeddings for semantic text search. For example, you can send text to an embedding model in[Azure OpenAI](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/embeddings), and it generates a vector representation that can be stored for analysis. For more information, see[Understand embeddings in Azure OpenAI Service](https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/understand-embeddings).
[](#general-workflow)## General workflow
[![Schematic of how to embed, store, and query text stored as vectors.](media/vector-database/vector-schematic.png)](media/vector-database/vector-schematic.png#lightbox)
The general workflow for using a vector database is as follows:
1. **Embed data**: Convert data into vector format using an embedding model. For example, you can embed text data using an OpenAI model.
2. **Store vectors**: Store the embedded vectors in a vector database. You can send the embedded data to an Eventhouse to store and manage the vectors.
3. **Embed query**: Convert the query data into vector format using the same embedding model used to embed the stored data.
4. **Query vectors**: Use vector similarity search to find entries in the database that are similar to the query.
[](#eventhouse-as-a-vector-database)## Eventhouse as a Vector Database
At the core of Vector Similarity Search is the ability to store, index, and query vector data. Eventhouses provide a solution for handling and analyzing large volumes of data, particularly in scenarios requiring real-time analytics and exploration, making it an excellent choice for storing and searching vectors.
The following components of the enable the use of Eventhouse a vector database:
* The[dynamic](https://learn.microsoft.com/en-us/kusto/query/scalar-data-types/dynamic?view=microsoft-fabric&amp;preserve-view=true)data type, which can store unstructured data such as arrays and property bags. Thus data type is recommended for storing vector values. You can further augment the vector value by storing metadata related to the original object as separate columns in your table.
* The[encoding](https://learn.microsoft.com/en-us/kusto/management/encoding-policy?view=microsoft-fabric&amp;preserve-view=true)type[`Vector16`](https://learn.microsoft.com/en-us/kusto/management/alter-encoding-policy#encoding-policy-types?view=microsoft-fabric&amp;preserve-view=true)designed for storing vectors of floating-point numbers in 16-bits precision, which uses the`Bfloat16`instead of the default 64 bits. This encoding is recommended for storing ML vector embeddings as it reduces storage requirements by a factor of four and accelerates vector processing functions such as[series\_dot\_product()](https://learn.microsoft.com/en-us/kusto/query/series-dot-product-function?view=microsoft-fabric&amp;preserve-view=true)and[series\_cosine\_similarity()](https://learn.microsoft.com/en-us/kusto/query/series-cosine-similarity-function?view=microsoft-fabric&amp;preserve-view=true)by orders of magnitude.
* The[series\_cosine\_similarity](https://learn.microsoft.com/en-us/kusto/query/series-cosine-similarity-function?view=microsoft-fabric&amp;preserve-view=true)function, which can perform vector similarity searches on top of the vectors stored in Eventhouse.
[](#optimize-for-scale)## Optimize for scale
For more information on optimizing vector similarity search, read the[blog](https://techcommunity.microsoft.com/t5/azure-data-explorer-blog/optimizing-vector-similarity-search-on-azure-data-explorer/ba-p/4033082).
To maximize performance and the resulting search times, follow the following steps:
1. Set the encoding of the embeddings column to Vector16, the 16-bit encoding of the vectors coefficients (instead of the default 64-bit).
2. Store the embedding vectors table on all cluster nodes with at least one shard per processor, which is done by the following steps:
1. Limit the number of embedding vectors per shard by altering the*ShardEngineMaxRowCount*of the[sharding policy](https://learn.microsoft.com/en-us/kusto/management/sharding-policy?view=microsoft-fabric&amp;preserve-view=true). The sharding policy balances data on all nodes with multiple extents per node so the search can use all available processors.
2. Change the*RowCountUpperBoundForMerge*of the[merging policy](https://learn.microsoft.com/en-us/kusto/management/merge-policy?view=microsoft-fabric&amp;preserve-view=true). The merge policy is needed to suppress merging extents after ingestion.
[](#example-optimization-steps)### Example optimization steps
In the following example, a static vector table is defined for storing 1M vectors. The embedding policy is defined as Vector16, and the sharding and merging policies are set to optimize the table for vector similarity search. For this let's assume the cluster has 20 nodes each has 16 processors. The tableâ€™s shards should contain at most 1000000/(20\*16)=3125 rows.
1. The following KQL commands are run one by one to create the empty table and set the required policies and encoding:
KustoCopy
```
`.createtableembedding\_vectors(vector\_id:long, vector:dynamic)// This is a sample selection of columns, you can add more columns.altercolumn embedding\_vectors.vectorpolicyencodingtype ='Vector16'// Store the coefficients in 16 bits instead of 64 bits accelerating calculation of dot product, suppress redundant indexing.alter-mergetableembedding\_vectorspolicysharding'{ "ShardEngineMaxRowCount" : 3125 }'// Balanced data on all nodes and, multiple extents per node so the search can use all processors.alter-mergetableembedding\_vectorspolicymerge'{ "RowCountUpperBoundForMerge" : 3125 }'// Suppress merging extents after ingestion`
```
2. Ingest the data to the table created and defined in the previous step.
[](#next-step)## Next step
[Tutorial: Use an Eventhouse as a vector database](vector-database-eventhouse)
## Feedback
Was this page helpful?
YesNoNo
Need help with this topic?
Want to try using Ask Learn to clarify or guide you through this topic?
Ask LearnAsk Learn
Suggest a fix?
## Additional resources
Training
Module
[Perform vector search and retrieval in Azure AI Search - Training](https://learn.microsoft.com/en-us/training/modules/improve-search-results-vector-search/?source=recommendations)
Perform vector search and retrieval in Azure AI Search.
Certification
[Microsoft Certified: Azure Cosmos DB Developer Specialty - Certifications](https://learn.microsoft.com/en-us/credentials/certifications/azure-cosmos-db-developer-specialty/?source=recommendations)
Write efficient queries, create indexing policies, manage, and provision resources in the SQL API and SDK with Microsoft Azure Cosmos DB.
Events
[FabCon Atlanta](https://aka.ms/fabconATL/t2learn)
Mar 16, 12 AM - Mar 20, 12 AM
Join us for the top Fabric, Power BI, AI &amp; SQL event. Save $200 with code FABLEARN.
[Register now](https://aka.ms/fabconATL/t2learn)
* Last updated on11/19/2024
Was this page helpful?
YesNoNo
Need help with this topic?
Want to try using Ask Learn to clarify or guide you through this topic?
Ask LearnAsk Learn
Suggest a fix?
## Ask Learn
Preview
Ask Learn is an AI assistant that can answer questions, clarify concepts, and define terms using trusted Microsoft documentation.
Please sign in to use Ask Learn.
[Sign in](#)
